<html>

<head>
  <style>
    table,
    th,
    td {
      margin: 10px 0;
      border: solid 1px #333;
      padding: 2px 4px;
      font: 15px Verdana;
    }

    th {
      font-weight: bold;
    }

    #loader {
      border: 16px solid #f3f3f3;
      border-radius: 50%;
      border-top: 16px solid blue;
      border-bottom: 16px solid blue;
      width: 60px;
      height: 60px;
      -webkit-animation: spin 2s linear infinite;
      animation: spin 2s linear infinite;
      visibility: hidden;
    }

    @-webkit-keyframes spin {
      0% {
        -webkit-transform: rotate(0deg);
      }

      100% {
        -webkit-transform: rotate(360deg);
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script>
    var script_url = "https://script.google.com/macros/s/AKfycbz4z8q84ChuyvXW2LChzwyUNGmyjynTljevfux5sPjCurX4l_0WeQF801eeox5tdGpo/exec";

    // Make an AJAX call to Google Script
    function insert_value() {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      $('#mySpinner').addClass('spinner');

      var id1 = $("#pro").val();
      var name = $("#complete").val();


      var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&action=insert";


      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });

    }

    function update_value() {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      var id1 = $("#pro").val();
      var name = $("#complete").val();
      var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&action=update";
      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });
    }

    function delete_value() {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      $('#mySpinner').addClass('spinner');
      var id1 = $("#pro").val();
      var name = $("#complete").val();
      var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&action=delete";
      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });
    }

    // print the returned data
    function ctrlq(e) {
      $("#re").html(e.result);
      $("#re").css("visibility", "visible");
      read_value();
    }

    function read_value() {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      var url = script_url + "?action=read";

      $.getJSON(url, function (json) {
        // Set the variables from the results array

        // CREATE DYNAMIC TABLE.
        var table = document.createElement("table");

        var header = table.createTHead();
        var row = header.insertRow(0);
        var cell1 = row.insertCell(1);
        var cell2 = row.insertCell(2);
        var cell2 = row.insertCell(3);
        var cell2 = row.insertCell(4);
        var cell2 = row.insertCell(5);
        var cell2 = row.insertCell(6);
        var cell2 = row.insertCell(7);

        cell1.innerHTML = "<b>date</b>";
        cell2.innerHTML = "<b>submitted</b>";
        cell2.innerHTML = "<b>pro</b>";
        cell2.innerHTML = "<b>revenue</b>";
        cell2.innerHTML = "<b>move-to</b>";
        cell2.innerHTML = "<b>notes</b>";
        cell2.innerHTML = "<b>complete-moved to</b>";

        // ADD JSON DATA TO THE TABLE AS ROWS.
        for (var i = 0; i < json.records.length; i++) {

          tr = table.insertRow(-1);
          var tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].ID;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].NAME;
        }

        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
        var divContainer = document.getElementById("showData");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
        document.getElementById("loader").style.visibility = "hidden";
        $("#re").css("visibility", "visible");
      });
    }
  </script>
</head>

<body>
  <div align="center">
    <h1>CRUD OPERATION ON GOOGLE SPREAD SHEET, WEB APPLICATION USING GOOGLE APP SCRIPT .</h1>
    <p>This is simple application, You can develop your own logic based on your requiremnets.<p>
        <p>Be careful with the parameters you are sending, it should match the parameters that are recived in google app script.</p>

        <form>
          Pro Number
          <input type="text" name="pro" id="pro">
          <input type="text" name="revenue" id="revenue">
          <input type="text" name="pro" id="pro">
          <select id="complete" name="complete">
	<option value="GILPG3AA" title="GILPG3AA">GILPG3AA</option>
	<option value="GILPG3AI" title="GILPG3AI">GILPG3AI</option>
	<option value="GILPG3AT" title="GILPG3AT">GILPG3AT</option>
	<option value="GILPG3BG" title="GILPG3BG">GILPG3BG</option>
	<option value="GILPG3BS" title="GILPG3BS">GILPG3BS</option>
	<option value="GILPG3CS" title="GILPG3CS">GILPG3CS</option>
	<option value="GILPG3DA" title="GILPG3DA">GILPG3DA</option>
	<option value="GILPG3DG" title="GILPG3DG">GILPG3DG</option>
	<option value="GILPG3DH" title="GILPG3DH">GILPG3DH</option>
	<option value="GILPG3DM" title="GILPG3DM">GILPG3DM</option>
	<option value="GILPG3DR" title="GILPG3DR">GILPG3DR</option>
	<option value="GILPG3HM" title="GILPG3HM">GILPG3HM</option>
	<option value="GILPG3HW" title="GILPG3HW">GILPG3HW</option>
	<option value="GILPG3JH" title="GILPG3JH">GILPG3JH</option>
	<option value="GILPG3JK" title="GILPG3JK">GILPG3JK</option>
	<option value="GILPG3JM" title="GILPG3JM">GILPG3JM</option>
	<option value="GILPG3JN" title="GILPG3JN">GILPG3JN</option>
	<option value="GILPG3JO" title="GILPG3JO">GILPG3JO</option>
	<option value="GILPG3KH" title="GILPG3KH">GILPG3KH</option>
	<option value="GILPG3LC" title="GILPG3LC">GILPG3LC</option>
	<option value="GILPG3MH" title="GILPG3MH">GILPG3MH</option>
	<option value="GILPG3MI" title="GILPG3MI">GILPG3MI</option>
	<option value="GILPG3MM" title="GILPG3MM">GILPG3MM</option>
	<option value="GILPG3NB" title="GILPG3NB">GILPG3NB</option>
	<option value="GILPG3OS" title="GILPG3OS">GILPG3OS</option>
	<option value="GILPG3SN" title="GILPG3SN">GILPG3SN</option>
	<option value="GILPG3SS" title="GILPG3SS">GILPG3SS</option>
	<option value="GILPG3ST" title="GILPG3ST">GILPG3ST</option>
	<option value="GILPG3SV" title="GILPG3SV">GILPG3SV</option>
	<option value="GILPG3TQ" title="GILPG3TQ">GILPG3TQ</option>
	<option value="GILPG3WP" title="GILPG3WP">GILPG3WP</option>
	<option value="GILPG3ZC" title="GILPG3ZC">GILPG3ZC</option>
	<option value="GILPTOJM" title="GILPTOJM">GILPTOJM</option>
</select>
        </form>

        <div id="loader"></div>

        <p id="re"></p>

        <input type="button" id="b1" onClick="insert_value()" value="Insert"></input>
        <input type="button" onclick="read_value()" value="Read" />
        <input type="button" onclick="update_value()" value="Update" />
        <input type="button" onclick="delete_value()" value="Delete" />
        <a href="YOUR_SPREADSHEET_LINK"
          target="_blank">Click here to open Spread Sheet </a>
        <div id="showData"></div>
  </div>
</body>
<html>
